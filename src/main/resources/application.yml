server:
  port: 8080
  servlet:
    context-path: /album

spring:
  datasource:
    url: jdbc:sqlite:${ALBUM_DB_PATH:./database.db}
    driver-class-name: org.sqlite.JDBC
    hikari:
      maximum-pool-size: 5
      minimum-idle: 1
      pool-name: SQLiteConnectionPool
      auto-commit: true
      
  jpa:
    hibernate:
      ddl-auto: update
    properties:
      hibernate:
        dialect: org.hibernate.community.dialect.SQLiteDialect
        jdbc:
          batch_size: 10
        order_inserts: true
        order_updates: true
        connection:
          pool_size: 5
        generate_statistics: false
        show_sql: false
        format_sql: false
        use_sql_comments: false

album:
  base-path: ${ALBUM_BASE_PATH:./photos}
  scan:
    enabled: true
    cron: "0 0 2 * * ?"  # 每天凌晨2点扫描
    incremental: true
    parallel:
      enabled: true
      thread-pool-size: 0  # 0表示自动使用CPU核心数
      batch-size: 50
  
  async:
    thumbnail:
      core-pool-size: 0  # 0表示自动使用CPU核心数
      max-pool-size: 0   # 0表示自动使用CPU核心数×2
      queue-capacity: 200
    heif-conversion:
      core-pool-size: 0  # 0表示自动使用max(4, CPU核心数)
      max-pool-size: 0   # 0表示自动使用CPU核心数×3
      queue-capacity: 100
    video-processing:
      core-pool-size: 0  # 0表示自动使用CPU核心数
      max-pool-size: 0   # 0表示自动使用CPU核心数×2
      queue-capacity: 50

  thumbnail:
    small: 300
    medium: 450
    large: 900
    quality: 0.8
    format: jpg
  
  cache:
    enabled: true
    memory-size: 1000
    disk-path: ${ALBUM_CACHE_DIR:./cache}
    
  video:
    ffmpeg-path: /usr/bin/ffmpeg
    enable-transcoding: false
    thumbnail-time-offset: 1.0  # 提取缩略图的时间偏移（秒）
    thumbnail-duration: 0.1      # 提取缩略图的持续时间（秒）